//
//  ProductDetailViewController.m
//  HDStock
//
//  Created by liyancheng on 16/12/13.
//  Copyright © 2016年 hd-app02. All rights reserved.
//

#import "ProductDetailViewController.h"
#import <WebKit/WebKit.h>
#import "HDLiveSubmitOrderViewController.h"
#import "panToPopObject.h"
@interface ProductDetailViewController ()
@property (nonatomic,strong) WKWebView * webView;
@end

@implementation ProductDetailViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    [self setNavCustemViewForLeftItemWithImage:imageNamed(@"Live_back") title:@"返回" titleFont:[UIFont systemFontOfSize:(15)] titleCoclor:[UIColor clearColor] custemViewFrame:CGRM(0, 26, 56, 44)];
    [self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:_urlStr]]];
    [self setBuyButton];
    [self panToPopView];
}

-(WKWebView *)webView{
    if(_webView == nil){
        _webView = [[WKWebView alloc] initWithFrame:CGRectMake(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT-50-64)];
        [self.view addSubview:_webView];
    }
    return _webView;
}



- (void)setBuyButton{
    UIButton * buyButton = [[UIButton alloc]initWithFrame:CGRectMake(0, SCREEN_HEIGHT-64-50, SCREEN_WIDTH, 50)];
    [buyButton setTitle:[NSString stringWithFormat:@"购买( ¥%@ )",_priceStr] forState:UIControlStateNormal];
    buyButton.backgroundColor = RGBCOLOR(25, 121, 202);
    [buyButton setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
    [buyButton addTarget:self action:@selector(goToPayPage) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:buyButton];
}

- (void)goToPayPage{
    HDLiveSubmitOrderViewController * submitOrder = [[HDLiveSubmitOrderViewController alloc]init];
    submitOrder.payAmountLabl.text = @"123";
    [self.navigationController pushViewController:submitOrder animated:YES];
}

- (void)panToPopView{
    UIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc]initWithTarget:self action:@selector(pan:)];
    [self.view addGestureRecognizer:pan];
}

- (void)pan:(UIPanGestureRecognizer *)pan{
    CGPoint startPoint;
    CGPoint changedPoint;
    CGPoint velocity = [pan velocityInView:self.view];
    if(velocity.x>0) {
        if(pan.state == UIGestureRecognizerStateBegan){
            startPoint = [pan locationInView:self.view];
        }
        if (pan.state ==UIGestureRecognizerStateChanged){
            changedPoint = [pan locationInView:self.view];
            if((changedPoint.x-startPoint.x)>60){
                [self.navigationController popViewControllerAnimated:YES];
            }
        }
    }
}




@end
