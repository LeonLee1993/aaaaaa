//
//  HDHeadLineModel.m
//  HDGolden
//
//  Created by hd-app02 on 16/10/19.
//  Copyright © 2016年 hd-app02. All rights reserved.
//

#import "HDHeadLineModel.h"
#import <WebKit/WebKit.h>

@interface HDHeadLineModel()<UIWebViewDelegate>

@property (nonatomic , strong) UIWebView * webview;

@end

@implementation HDHeadLineModel

- (CGFloat)cellHeight{
    
    if (!_cellHeight) {
        
        CGFloat screenW = [UIScreen mainScreen].bounds.size.width - 16;
        
        CGFloat contentW = [self.title sizeWithAttributes:@{NSFontAttributeName :[UIFont systemFontOfSize:16]}].width;
        
        if(self.pic.length > 1){
            
            if (!self.countmanypic) {
                
                return 106;
                
            }
            if (self.countmanypic) {
                
                if (self.countmanypic == 1) {
                    
                    return 106;
                    
                }else if (self.countmanypic == 2){
                    
                    if (contentW > screenW) {
                        
                        _cellHeight = 301;
                        
                    }else{
                        
                        _cellHeight = 271;
                        
                    }
                    
                }else if (self.countmanypic == 3){
                    
                    if (contentW > screenW) {
                        
                        _cellHeight = 156;
                        
                    }else{
                        
                        _cellHeight = 136;
                        
                    }
                    
                }
            }
        }
        if (self.pic.length == 0) {
            
            if (!self.countmanypic) {
                
                if (contentW > screenW) {
                    
                    _cellHeight = 98;
                    
                }else{
                    
                    _cellHeight = 78;
                    
                }
            }
            
            if (self.countmanypic) {
                if (self.countmanypic == 1) {
                    
                    return  106;
                    
                }else if (self.countmanypic == 2){
                    
                    if (contentW > screenW) {
                        
                        _cellHeight = 301;
                        
                    }else{
                        
                        _cellHeight = 271;
                        
                    }
                    
                }else if (self.countmanypic == 3){
                    
                    if (contentW > screenW) {
                        
                        _cellHeight = 156;
                        
                    }else{
                        
                        _cellHeight = 136;
                        
                    }
                    
                }
            }
        }
    }
    
    return _cellHeight * HEIGHT;
}


-(NSString *)tagText{

    if (!_tagText) {
        
        _tagText = self.tags_name[@"6"];
        
    }

    return _tagText;

}
    
- (CGFloat)webCellHeight{

    if (!_webCellHeight) {
        
        self.webview = [[UIWebView alloc]initWithFrame:CGRectMake(0, 0, SCREEN_WIDTH - 20, 0)];
        
        self.webview.delegate = self;
        [self.webview loadHTMLString:self.content baseURL:nil];
        
        _webCellHeight = [self.webview stringByEvaluatingJavaScriptFromString:@"document.body.offsetHeight"].floatValue;
        
    }

    return _webCellHeight * 3;

}

- (void)webViewDidFinishLoad:(UIWebView *)webView{

    _webCellHeight = [self.webview stringByEvaluatingJavaScriptFromString:@"document.body.offsetHeight"].floatValue;

}

@end
