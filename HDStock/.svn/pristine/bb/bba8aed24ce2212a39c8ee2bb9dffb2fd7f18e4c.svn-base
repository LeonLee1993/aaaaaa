//
//  HDInfoMationViewController.m
//  HDStock
//
//  Created by hd-app02 on 16/11/14.
//  Copyright © 2016年 hd-app02. All rights reserved.
//

#import "HDInfoMationViewController.h"
#import "ZWTopSelectButton.h"
#import "ZWTopSelectVcView.h"

#import "ZJScrollPageView.h"

#import "UIParameter.h"
#import "NinaPagerView.h"

#import "HDInfoViewController.h"
#import "HDOnlyFaViewController.h"
#import "HDBaskListViewController.h"
#import "HDVideoViewController.h"
#import "HDSearchSomeThingViewController.h"

@interface HDInfoMationViewController ()<ZWTopSelectVcViewDelegate,HDInfoViewDelegate,NinaPagerViewDelegate>

@property (nonatomic, strong) ZWTopSelectVcView *topSelectVcView;

@property (nonatomic, strong) NinaPagerView *ninaPagerView;

@end

@implementation HDInfoMationViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    
    self.view.backgroundColor = COLOR(whiteColor);
    
    //第一步：初始化ZWTopSelectVcView，把其加入当前控制器view中
//    _topSelectVcView=[[ZWTopSelectVcView alloc]init];
//    
//    _topSelectVcView.frame=CGRectMake(0, 20, self.view.frame.size.width, self.view.frame.size.height - STATUS_HEIGHT - TABBAR_HEIGHT);
//    [self.view addSubview:_topSelectVcView];
//    
//    //第二步：设置ZWTopSelectVcView的代理
//    self.topSelectVcView.delegate=self;
//    
//    self.topSelectVcView.isCloseSwipeGesture = YES;
//    
//    //第三步： 开始ZWTopSelectVcViewUI绘制,必须实现！
//    [self.topSelectVcView setupZWTopSelectVcViewUI];
//    
//    //控制器切换动画时间
//    //self.topSelectVcView.speedTime=1;
//    //设置动画效果，默认为push
//    // self.topSelectVcView.animationType=8;
//    //关闭动画效果
//    self.topSelectVcView.isCloseAnimation = YES;
//    //隐藏底部滑块
//    //self.topSelectVcView.viewUnder.hidden=YES;
//
//    //单个设置(可选) ：通过topSelectVcView找到对应的单个顶部button，从左到右如,topViewFirstbtn，topViewSecondbtn,topViewThirdbtn,以此类推;
//    
//    [self setupSingleButton];
//    [self setupSearchButton];
    [self.view addSubview:self.ninaPagerView];
    
    
}

#pragma mark - LazyLoad
- (NinaPagerView *)ninaPagerView {
    if (!_ninaPagerView) {
        //Need You Edit
        NSArray *titleArray = [self ninaTitleArray];
        //Three choices
        //NSArray *vcsArray = [self ninaVCsArray];
        //NSArray *viewsArray = [self ninaViewsArray];
        NSArray *detailVCsArray = [self ninaDetailVCsArray];
        /**
         *  创建ninaPagerView，控制器第一次是根据您划的位置进行相应的添加的，类似网易新闻虎扑看球等的效果，后面再滑动到相应位置时不再重新添加，如果想刷新数据，您可以在相应的控制器里加入刷新功能。需要注意的是，在创建您的控制器时，设置的frame为FUll_CONTENT_HEIGHT，即全屏高减去导航栏高度，如果这个高度不是您想要的，您可以去在下面的frame自定义设置。
         *  A tip you should know is that when init the VCs frames,the default frame i set is FUll_CONTENT_HEIGHT,it means fullscreen height - NavigationHeight - TabbarHeight.If the frame is not what you want,just set frame as you wish.
         */
        CGRect pagerRect = CGRectMake(0, 0, FUll_VIEW_WIDTH, FUll_CONTENT_HEIGHT);
        _ninaPagerView = [[NinaPagerView alloc] initWithFrame:pagerRect WithTitles:titleArray WithVCs:detailVCsArray];
        _ninaPagerView.ninaPagerStyles = NinaPagerStyleBottomLine;
        _ninaPagerView.ninaDefaultPage = 2;
        _ninaPagerView.loadWholePages = NO;
        _ninaPagerView.topTabHeight = 64;
        _ninaPagerView.topTabBackGroundColor = MAIN_COLOR;
        
    }
    return _ninaPagerView;
}

#pragma mark - ScrollHiddenDelegate
- (void)upScrollAction:(BOOL)show {
    //If you wanna to make toptab hidden or show,you can try following codes and choose detailVCsArray(Line 39) as your default vcs array:
    //    self.ninaPagerView.topTabScrollHidden = show?NO:YES;
}

#pragma mark - NinaParaArrays
/**
 *  上方显示标题(您需要注意的是，虽然框架中对长标题进行了优化处理，但是建议您设置标题时汉字的长度不要超过10)。
 *  Titles showing on the topTab
 *
 *  @return Array of titles.
 */
- (NSArray *)ninaTitleArray {
    return @[
             @"大连市",
             @"甘井子",
             @"星海广场",
             @"西岗",
             ];
}


/**
 *  WithVCs传入方法3：适用于IB创建或者需要代码实例化创建的VC，如果您有此需求，请传入对应的VC即可，具体实现可参照下方代码。
 *  If you think vcs is not comfortable for your project, you can use view arrays to built.Just put views into array.
 *
 *  @return Array of views or controllers
 */
- (NSArray *)ninaDetailVCsArray {
    //Test init views and viewcontrollers,support creating views or viewcontroller by xib.
    HDInfoViewController *firstVC = [HDInfoViewController new];
    //firstVC.upScrollDelegate = self;
    HDOnlyFaViewController *secondVC = [HDOnlyFaViewController new];
    HDBaskListViewController *firstTV = [[HDBaskListViewController alloc] init];
    HDVideoViewController *forthCollectionView = [[HDVideoViewController alloc] init];
    return @[
             firstVC,
             secondVC,
             firstTV,
             forthCollectionView,
             ];
}

- (void)setupSearchButton{

    UIButton * searchButton = [[UIButton alloc]initWithFrame:CGRectMake(self.view.frame.size.width * 4 / 5, 20, self.view.frame.size.width / 5, 50)];
    
        [searchButton setImage:imageNamed(@"ss_icon") forState:UIControlStateNormal];
    
        [searchButton addTarget:self action:@selector(searchButtonOnClicked:) forControlEvents:UIControlEventTouchUpInside];

    [self.view addSubview:searchButton];
}

/**
 *   单个设置(可选) ：
 *   通过topSelectVcView找到对应的单个顶部button，从左到右如,topViewFirstbtn，topViewSecondbtn,topViewThirdbtn,以此类推;
 */
-(void)setupSingleButton
{
    //  优先级最高
    self.topSelectVcView.topViewFirstbtn.labName.text = @"资讯";
    self.topSelectVcView.topViewSecondbtn.labName.text = @"独家";
    self.topSelectVcView.topViewThirdbtn.labName.text = @"晒单";
    self.topSelectVcView.topViewFourthbtn.labName.text = @"视频";

}

- (void)searchButtonOnClicked:(UIButton *)button{

    HDSearchSomeThingViewController * vc = [[HDSearchSomeThingViewController alloc]init];
    
    vc.view.backgroundColor = COLOR(whiteColor);
    
    [self.navigationController pushViewController:vc animated:NO];

}

#pragma mark - ZWTopSelectVcViewDelegate

//初始化设置
-(NSMutableArray *)totalControllerInZWTopSelectVcView:(ZWTopSelectVcView *)topSelectVcView
{
    
    NSMutableArray *controllerMutableArr=[NSMutableArray array];
    
    HDInfoViewController * infoViewCon = [[HDInfoViewController alloc]init];
    
    infoViewCon.delegate = self;
    
    [controllerMutableArr addObject:infoViewCon];
    
    
    [controllerMutableArr addObject:[[HDOnlyFaViewController alloc]init]];
    [controllerMutableArr addObject:[[HDBaskListViewController alloc]init]];
    [controllerMutableArr addObject:[[HDVideoViewController alloc]init]];
    
    return controllerMutableArr;
    
}

#pragma mark - ZWTopSelectVcViewDelegate
//不修改,则为默认
-(void)totalTopZWTopSelectButton:(ZWTopSelectButton *)totalTopBtns IntopSelectVcView:(ZWTopSelectVcView *)topSelectVcView
{
    
    totalTopBtns.labName.font=[UIFont systemFontOfSize:18];
    
    totalTopBtns.selectedColor = MAIN_COLOR;
    
    totalTopBtns.notSelectedColor = COLOR(blackColor);
    
    
}

-(CGFloat)topViewWidthInZWTopSelectVcView:(ZWTopSelectVcView *)topSelectVcView{

    return self.view.frame.size.width * 4 / 5;

}


#pragma mark == InfoViewControllerDelegate
- (void)viewWillAppear:(BOOL)animated{

    [self.navigationController.navigationBar setHidden:YES];

}

- (void)turnToAntherControllerOnClicked:(UIButton *)button toPushToController:(UIViewController *)viewController{

    [self.navigationController pushViewController:viewController animated:YES];

}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

/*
#pragma mark - Navigation

// In a storyboard-based application, you will often want to do a little preparation before navigation
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    // Get the new view controller using [segue destinationViewController].
    // Pass the selected object to the new view controller.
}
*/

@end
