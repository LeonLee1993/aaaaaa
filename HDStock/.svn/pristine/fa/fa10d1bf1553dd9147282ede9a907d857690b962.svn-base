//
//  HDPSYScrollButtonView.m
//  HDStock
//
//  Created by hd-app02 on 16/11/11.
//  Copyright © 2016年 hd-app02. All rights reserved.
//

#import "HDPSYScrollButtonView.h"

#define VIEW_H self.bounds.size.height
#define VIEW_W self.bounds.size.width

@interface HDPSYScrollButtonView()<UIScrollViewDelegate>{
    
    NSInteger count;
    
    UIScrollView * scrollview ;
    
}

@property (nonatomic, strong) NSArray * imageArray;

@property (nonatomic, strong) NSArray * titleArray;

@property (nonatomic, assign) CGFloat BWidth;

@property (nonatomic, assign) CGFloat BHeight;

@property (nonatomic, assign) NSInteger margin;

@property (nonatomic, strong) NSMutableArray * buttonArray;

@end

@implementation HDPSYScrollButtonView

- (NSMutableArray *)buttonArray{

    if (!_buttonArray) {
        
        _buttonArray = [[NSMutableArray alloc]init];
        
    }

    return _buttonArray;

}

- (instancetype)initWithCoder:(NSCoder *)aDecoder{

    if (self = [super initWithCoder:aDecoder]) {
        
            _margin = 10;
            
            _titleArray = @[@"按钮",@"按钮",@"按钮",@"按钮",@"按钮",@"按钮"];
            
            UIGraphicsBeginImageContextWithOptions(CGSizeMake(36, 36), NO, 0.0);
            UIImage *blank = UIGraphicsGetImageFromCurrentImageContext();
            UIGraphicsEndImageContext();
            
            _imageArray = @[imageNamed(@"1image"),imageNamed(@"2image"),imageNamed(@"3image"),imageNamed(@"4image"),imageNamed(@"5image"),blank];
            
            count = _titleArray.count;
            
            _BWidth = (VIEW_W - 3 * _margin)/2.8;
            
            _BHeight = VIEW_H - 2 * _margin;
        
        
        
        NSLog(@"%f====%f",_BHeight,VIEW_H);
        
        scrollview = [[UIScrollView alloc]initWithFrame:CGRectZero];
        
        scrollview.showsHorizontalScrollIndicator = NO;
        
        scrollview.delegate = self;

        
        for (int i = 0; i < count; i ++) {
            
            UIButton * button = [[UIButton alloc]init];
            
            [self setButtonProperty:button andTag:i + 1];
            
            [scrollview addSubview:button];
            
            [self.buttonArray addObject:button];
        }
        
        [self addSubview:scrollview];
        
    }

    return self;

}

- (void)layoutSubviews{
    [super layoutSubviews];

    [self creatButtons];

}

- (void)creatButtons{
    
    scrollview.frame = CGRectMake(0, 0, VIEW_W, VIEW_H);
    
    for (int i = 0; i < self.buttonArray.count; i ++) {
        
        UIButton * button = self.buttonArray[i];
        
        button.frame = CGRM(i * (_margin + _BWidth) + _margin, _margin, _BWidth, _BHeight);
    
    
    }
    
    scrollview.contentSize = CGSizeMake(self.buttonArray.count * (_BWidth + _margin) + _margin, VIEW_H);
}

- (void)setButtonProperty:(UIButton *)button andTag:(int)tag{
    
    button.backgroundColor = COLOR(redColor);
    
    [button setTitle:[_titleArray objectAtIndex:(tag - 1)] forState:UIControlStateNormal];
    [button setImage:[_imageArray objectAtIndex:(tag - 1)] forState:UIControlStateNormal];
    [button setImage:[_imageArray objectAtIndex:(tag - 1)] forState:UIControlStateHighlighted];
    [button setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
    
    //button.backgroundColor = [UIColor redColor];
    button.titleLabel.font = [UIFont systemFontOfSize:15];
    button.titleLabel.textAlignment = NSTextAlignmentCenter;
    
    [button setAdjustsImageWhenDisabled:NO];
    button.tag = tag;
    [button addTarget:self action:@selector(buttonOnTouch:) forControlEvents:UIControlEventTouchUpInside];
    
}

- (void)buttonOnTouch:(UIButton *)button{
    
    NSLog(@"点击%lu",(long)button.tag);
    
}



@end
