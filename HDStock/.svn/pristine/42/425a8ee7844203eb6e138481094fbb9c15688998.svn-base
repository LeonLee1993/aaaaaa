//
//  HDPersonInfoViewController.m
//  HDStock
//
//  Created by hd-app01 on 16/11/16.
//  Copyright © 2016年 hd-app02. All rights reserved.
//

#import "HDPersonInfoViewController.h"
#import "HDPersonChangeNameViewController.h"
#import "HDPersonChangePasswordViewController.h"
#import "HDPersonChangePhoneNumViewController.h"
#import "HDPersonSetTrueNameViewController.h"

@interface HDPersonInfoViewController ()<UITableViewDelegate,UITableViewDataSource> {
    UIView * headBgView;//头部背景视图
    UIImageView * headPicIMV;//头像imv
    CGFloat headPicWidth;//头像宽度
    UITableView * _tb;
    NSArray * tabTitleArr;//表格标题
    NSMutableArray * detailInfoArr;//个人信息简介
    NSArray * changeDetailVCArr;//修改详细信息VC；
}

@end

@implementation HDPersonInfoViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    
    [self setUp];
    
    [self setNormalBackNav];
    
    [self createUI];
}

- (void) setUp {
    
    self.title = @"个人信息";
    headPicWidth = 80;//头像高度
    tabTitleArr = @[@"昵称",@"密码",@"手机号",@"实名认证"];
    detailInfoArr = [[NSMutableArray alloc] initWithArray:@[@"胜者为王",@"",@"136*＊＊＊997",@"未认证"]];
    changeDetailVCArr = @[[HDPersonChangeNameViewController new],[HDPersonChangePasswordViewController new],[HDPersonChangePhoneNumViewController new],[HDPersonSetTrueNameViewController new]];
    
}

- (void) createUI {
    //头像
    headBgView = [self createHeadBgView];
    [self.view addSubview:headBgView];
    //表格
    [self createPlainTB];
    
}
- (UIView *) createHeadBgView {
    
    //背景
    UIView * tempHeadBgView = [[UIView alloc] initWithFrame:CGRM(0, 0, SCREEN_WIDTH, 160)];
    tempHeadBgView.backgroundColor = UICOLOR(173, 128, 61, 1);
    
    //头像
    headPicIMV =  [[UIImageView alloc] initWithFrame:CGRM(CGMID_X(tempHeadBgView.frame)-headPicWidth/2, CGMID_Y(tempHeadBgView.frame)-headPicWidth/2, headPicWidth, headPicWidth)];
    headPicIMV.image = imageNamed(@"weidenglu");
    headPicIMV.layer.cornerRadius = headPicWidth/2;
    headPicIMV.layer.masksToBounds = YES;
    [tempHeadBgView addSubview:headPicIMV];
    
    return tempHeadBgView;
}

#pragma mark - 创建表格
- (void ) createPlainTB {
    
    UITableView * tb = [[UITableView alloc] initWithFrame:CGRectMake(0, CGMAX_Y(headBgView.frame), SCREEN_SIZE_WIDTH, SCREEN_SIZE_HEIGHT - CGMAX_Y(headBgView.frame)) style:(UITableViewStylePlain)];
    tb.showsVerticalScrollIndicator = NO;
    tb.tableFooterView = [[UIView alloc] init];
    tb.delegate = self;
    tb.dataSource = self;
    tb.bounces = NO;
    _tb = tb;
    [self.view addSubview:_tb];
}

- (NSInteger) tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return tabTitleArr.count;
}

- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return 50;
}

- (UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString * reuseID = @"reuseCell";
    UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:reuseID];
    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:(UITableViewCellStyleValue1) reuseIdentifier:reuseID];
    }
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    cell.textLabel.text = tabTitleArr[indexPath.row];
    cell.detailTextLabel.text = detailInfoArr[indexPath.row];
    
    return cell;
}

- (void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    
    UITableViewCell * cell = [tableView cellForRowAtIndexPath:indexPath];
    
    changeDetailVCArr = @[[HDPersonChangeNameViewController new],[HDPersonChangePasswordViewController new],[HDPersonChangePhoneNumViewController new],[HDPersonSetTrueNameViewController new]];

    switch (indexPath.row) {
        case 0:
        {//昵称
            HDPersonChangeNameViewController * nameVC = [HDPersonChangeNameViewController new];
            nameVC.changNickNameBlock = ^(NSString * changedNickName){
                cell.detailTextLabel.text = changedNickName;
            };
            [self.navigationController pushViewController:nameVC animated:YES];

        }
            break;
        case 1:
        {//密码
            HDPersonChangePasswordViewController * passwordVC = [HDPersonChangePasswordViewController new];
            [self.navigationController pushViewController:passwordVC animated:YES];
        }
            break;
        case 2:
        {//电话
            HDPersonChangePhoneNumViewController * phoneVC = [HDPersonChangePhoneNumViewController new];
            [self.navigationController pushViewController:phoneVC animated:YES];
        }
            break;
        case 3:
        {//实名认证
            HDPersonSetTrueNameViewController * trueNameVC = [HDPersonSetTrueNameViewController new];
            [self.navigationController pushViewController:trueNameVC animated:YES];
        }
            break;
        default:
            break;
    }
}



#pragma mark - foo
- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

/*
#pragma mark - Navigation

// In a storyboard-based application, you will often want to do a little preparation before navigation
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    // Get the new view controller using [segue destinationViewController].
    // Pass the selected object to the new view controller.
}
*/

@end
