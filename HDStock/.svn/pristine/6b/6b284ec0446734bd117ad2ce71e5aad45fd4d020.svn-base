//
//  ProductDetailViewController.m
//  HDStock
//
//  Created by liyancheng on 16/12/13.
//  Copyright © 2016年 hd-app02. All rights reserved.
//

#import "ProductDetailViewController.h"
#import <WebKit/WebKit.h>
#import "HDLiveSubmitOrderViewController.h"
#import "panToPopObject.h"
@interface ProductDetailViewController ()

@end

@implementation ProductDetailViewController{
    WKWebView * webView;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    
//    UIImageView * backImage = [[UIImageView alloc]initWithFrame:CGRectMake(10, 13, 12, 19)];
//    backImage.image = [UIImage imageNamed:@"back_icon"];
//    backImage.userInteractionEnabled = YES;
//    UIBarButtonItem *backItem = [[UIBarButtonItem alloc] initWithCustomView:backImage];
//    self.navigationItem.leftBarButtonItem = backItem;
    
//    [self setnav]setNavCustemViewForLeftItemWithImage:(UIImage *)image title:(NSString *)title titleFont:(UIFont *)font titleCoclor:(UIColor *)titleCoclor custemViewFrame:(CGRect)thyFrame;
    
//    [self setNavCustemViewForLeftItemWithImage:[UIImage imageNamed:@"back_icon"] title:nil titleFont:nil titleCoclor:nil custemViewFrame:CGRectMake(30, 13, 12, 19)];
    [self setNormalBackNav];
    
    if(!webView){
        webView = [[WKWebView alloc] initWithFrame:CGRectMake(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT-50-64)];
        [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:_urlStr]]];
        [self.view addSubview:webView];
    }
    [self setBuyButton];
    [self panToPopView];
}

- (void)setBuyButton{
    UIButton * buyButton = [[UIButton alloc]initWithFrame:CGRectMake(0, SCREEN_HEIGHT-64-50, SCREEN_WIDTH, 50)];
    [buyButton setTitle:[NSString stringWithFormat:@"购买( ¥%@ )",_priceStr] forState:UIControlStateNormal];
    buyButton.backgroundColor = RGBCOLOR(25, 121, 202);
    [buyButton setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
    [buyButton addTarget:self action:@selector(goToPayPage) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:buyButton];
}

- (void)goToPayPage{
    HDLiveSubmitOrderViewController * submitOrder = [[HDLiveSubmitOrderViewController alloc]init];
    submitOrder.payAmountLabl.text = @"123";
    [self.navigationController pushViewController:submitOrder animated:YES];
}

- (void)panToPopView{
    UIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc]initWithTarget:self action:@selector(pan:)];
    [self.view addGestureRecognizer:pan];
}

- (void)pan:(UIPanGestureRecognizer *)pan{
    CGPoint startPoint;
    CGPoint changedPoint;
    CGPoint velocity = [pan velocityInView:self.view];
    if(velocity.x>0) {
        if(pan.state == UIGestureRecognizerStateBegan){
            startPoint = [pan locationInView:self.view];
        }
        if (pan.state ==UIGestureRecognizerStateChanged){
            changedPoint = [pan locationInView:self.view];
            if((changedPoint.x-startPoint.x)>60){
                [self.navigationController popViewControllerAnimated:YES];
            }
        }
    }
}




@end
